<script>
const GAME_CODE='Ø§Ù„Ø­Ù…Ø¯Ø§Ù„Ù„Ù‡1';
let codeUsed=false; // Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø±Ù…Ø² Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©
const FAMILY_LINK='https://www.facebook.com/profile.php?id=61581366775114';

let playerName='',currentQ=0,score=0,timeLeft=60,timerInterval;

const welcomeCard=document.getElementById('welcomeCard');
const messageCard=document.getElementById('messageCard');
const quizCard=document.getElementById('quizCard');
const resultCard=document.getElementById('resultCard');
const nameInput=document.getElementById('nameInput');
const codeInput=document.getElementById('codeInput');
const startBtn=document.getElementById('startBtn');
const welcomeMsg=document.getElementById('welcomeMsg');
const questionArea=document.getElementById('questionArea');
const timerEl=document.getElementById('timer');
const timerBar=document.getElementById('timerBar');
const feedback=document.getElementById('feedback');
const resultText=document.getElementById('resultText');
const playerResultName=document.getElementById('playerResultName');
const copyBtn=document.getElementById('copyBtn');
const goFamilyBtn=document.getElementById('goFamilyBtn');
const restartBtn=document.getElementById('restartBtn');

startBtn.onclick=()=>{
    const name=nameInput.value.trim();
    const code=codeInput.value.trim();
    if(!name){alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù…');return;}
    if(codeUsed){alert('âš ï¸ ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ø±Ù…Ø² Ù…Ø³Ø¨Ù‚Ø§Ù‹ ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰'); return;}
    if(code!==GAME_CODE){alert('Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­');return;}
    
    playerName=name;
    codeUsed=true; // ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø±Ù…Ø² Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©
    welcomeCard.classList.add('hidden');
    messageCard.classList.remove('hidden');
    welcomeMsg.textContent=`Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ${name} ÙÙŠ Ø¹Ø§Ø¦Ù„Ø© Ù†Ø¹ÙˆÙ…ØªÙƒ ğŸ’–`;
    setTimeout(()=>{messageCard.classList.add('hidden');startQuiz();},5000);
}

function startQuiz(){
    quizCard.classList.remove('hidden');
    currentQ=0;score=0;
    showQuestion();
    startTimer();
}

function startTimer(){
    clearInterval(timerInterval);
    timeLeft=60;
    updateTimer();
    timerInterval=setInterval(()=>{
        timeLeft--;
        updateTimer();
        if(timeLeft<=0){nextQuestion();}
    },1000);
}

function updateTimer(){
    timerEl.textContent=`${String(Math.floor(timeLeft/60)).padStart(2,'0')}:${String(timeLeft%60).padStart(2,'0')}`;
    timerBar.style.width=(timeLeft/60*100)+'%';
}

function showQuestion(){
    if(currentQ>=QUESTIONS.length){finishQuiz();return;}
    timeLeft=60;updateTimer();feedback.textContent='';
    const q=QUESTIONS[currentQ];
    let html=`<h3>Ø³Ø¤Ø§Ù„ ${currentQ+1}: ${q.q}</h3><div class="options">`;
    q.opts.forEach((o,i)=>{html+=`<div class="opt" onclick="selectOption(${i})">${o}</div>`;});
    html+='</div>';
    questionArea.innerHTML=html;
}

function selectOption(i){
    const q=QUESTIONS[currentQ];
    if(i===q.a){score+=10;feedback.textContent=`Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© âœ…`;}
    else{feedback.textContent=`Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø© âŒ`;}
    setTimeout(()=>{nextQuestion();},1500);
}

function nextQuestion(){
    currentQ++;
    if(currentQ<QUESTIONS.length)showQuestion();else finishQuiz();
}

function finishQuiz(){
    clearInterval(timerInterval);
    quizCard.classList.add('hidden');
    resultCard.classList.remove('hidden');
    playerResultName.textContent=playerName;
    resultText.textContent=`Ù„Ù‚Ø¯ Ø­ØµÙ„Øª Ø¹Ù„Ù‰ ${score} Ù…Ù† ${QUESTIONS.length*10} Ù†Ù‚Ø·Ø©!`;
}

copyBtn.onclick=async()=>{await navigator.clipboard.writeText(resultText.textContent);alert('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†ØªÙŠØ¬Ø©!');}
goFamilyBtn.onclick=()=>{window.open(FAMILY_LINK,'_blank');}

// ØªØ¹Ø¯ÙŠÙ„ Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
restartBtn.onclick=()=>{
    alert('Ù‡Ù‡Ù‡Ù‡Ù‡ Ù„Ù‚Ø¯ Ø®Ø¯Ø¹Ù†Ø§ÙƒÙŠ ğŸ˜');
    setTimeout(()=>{
        resultCard.classList.remove('hidden'); // Ø¥Ø¹Ø§Ø¯Ø© Ø¸Ù‡ÙˆØ± ØµÙØ­Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø¨Ø¹Ø¯ 10 Ø«ÙˆØ§Ù†ÙŠ
    },10000);
}
</script>
